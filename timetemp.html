<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ƒê·ªìng H·ªì Th√¥ng Minh - ESP32</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Reset v√† base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a2980, #26d0ce);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        /* Container ch√≠nh */
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background-color: rgba(255, 255, 255, 0.97);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.25);
            overflow: hidden;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Header */
        .header {
            background: linear-gradient(to right, #0f2027, #203a43, #2c5364);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(to right, #00b4db, #0083b0);
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        .header h1 i {
            color: #00b4db;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        /* Status bar */
        .status-bar {
            display: flex;
            justify-content: space-between;
            background: linear-gradient(to right, #f8f9fa, #e9ecef);
            padding: 15px 30px;
            border-bottom: 1px solid #dee2e6;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 500;
        }

        .status-item i {
            font-size: 1.3rem;
        }

        .status-item.online {
            color: #28a745;
        }

        .status-item.offline {
            color: #dc3545;
        }

        /* Hi·ªÉn th·ªã th·ªùi gian l·ªõn */
        .time-display {
            text-align: center;
            padding: 30px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            margin: 20px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .current-time {
            font-size: 4.5rem;
            font-weight: 700;
            font-family: 'Courier New', monospace;
            letter-spacing: 3px;
            margin-bottom: 10px;
            text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        }

        .current-date {
            font-size: 1.4rem;
            opacity: 0.9;
        }

        /* Layout ch√≠nh */
        .dashboard {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 30px;
        }

        @media (max-width: 992px) {
            .dashboard {
                grid-template-columns: 1fr;
            }
        }

        /* Card styles */
        .card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid #e9ecef;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
        }

        .card-title {
            font-size: 1.5rem;
            margin-bottom: 25px;
            color: #2c3e50;
            display: flex;
            align-items: center;
            gap: 15px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .card-title i {
            color: #3498db;
        }

        /* Alarm controls */
        .time-input-group {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
            margin-bottom: 25px;
        }

        .time-input {
            width: 100px;
            height: 80px;
            font-size: 3rem;
            text-align: center;
            border: 3px solid #3498db; /* M√†u xanh cho input */
            border-radius: 12px;
            font-weight: 700;
            color: #2c3e50;
            background: white;
            transition: all 0.3s;
        }

        .time-input:focus {
            border-color: #2980b9;
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.2);
            outline: none;
        }

        .time-separator {
            font-size: 3rem;
            font-weight: 700;
            color: #3498db; /* M√†u xanh cho d·∫•u hai ch·∫•m */
        }

        .sound-select {
            width: 100%;
            padding: 15px;
            border: 2px solid #3498db; /* M√†u xanh cho select */
            border-radius: 10px;
            font-size: 1.1rem;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 25px;
            color: #2c3e50;
        }

        .sound-select:focus {
            border-color: #2980b9;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }

        /* Button styles */
        .btn-group {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
        }

        .btn {
            flex: 1;
            padding: 18px 25px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
        }

        .btn i {
            font-size: 1.2rem;
        }

        .btn-enable {
            background: linear-gradient(to right, #00b09b, #96c93d);
            color: white;
        }

        .btn-enable:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(0, 176, 155, 0.3);
        }

        .btn-disable {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
            color: white;
        }

        .btn-disable:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(255, 65, 108, 0.3);
        }

        .btn-snooze {
            background: linear-gradient(to right, #ff9500, #ff5e3a);
            color: white;
        }

        .btn-snooze:hover {
            transform: translateY(-3px);
            box-shadow: 0 7px 20px rgba(255, 149, 0, 0.3);
        }

        /* Alarm status */
        .alarm-status {
            text-align: center;
            padding: 20px;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1.3rem;
            transition: all 0.3s;
            margin-top: 15px;
        }

        .alarm-status.on {
            background: linear-gradient(135deg, rgba(0, 176, 155, 0.1), rgba(150, 201, 61, 0.1));
            color: #27ae60;
            border: 2px solid #2ecc71;
        }

        .alarm-status.off {
            background: linear-gradient(135deg, rgba(255, 65, 108, 0.1), rgba(255, 75, 43, 0.1));
            color: #e74c3c;
            border: 2px solid #e74c3c;
        }

        /* Control buttons */
        .control-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 25px;
        }

        .control-btn {
            padding: 25px 15px;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border: 2px solid #3498db; /* M√†u xanh cho border */
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 12px;
            color: #3498db; /* M√†u xanh cho ch·ªØ */
        }

        .control-btn:hover {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            transform: translateY(-3px);
            border-color: #2980b9;
            color: #2980b9;
            box-shadow: 0 8px 20px rgba(52, 152, 219, 0.15);
        }

        .control-btn i {
            font-size: 2rem;
            color: #3498db;
        }

        /* Info grid */
        .info-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-top: 25px;
        }

        .info-item {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            padding: 20px;
            border-radius: 12px;
            border-left: 5px solid #3498db; /* M√†u xanh cho border-left */
        }

        .info-label {
            font-size: 0.9rem;
            color: #3498db; /* M√†u xanh cho label */
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .info-value {
            font-size: 1.4rem;
            font-weight: 700;
            color: #2c3e50;
        }

        /* Weather display */
        .weather-display {
            display: flex;
            justify-content: space-around;
            background: linear-gradient(135deg, #3498db, #2980b9); /* M√†u xanh ƒë·∫≠m */
            color: white;
            padding: 25px;
            border-radius: 12px;
            margin-top: 25px;
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
        }

        .weather-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .weather-icon {
            font-size: 2.5rem;
            color: white;
        }

        .weather-value {
            font-size: 2rem;
            font-weight: 700;
        }

        .weather-label {
            font-size: 1rem;
            opacity: 0.9;
        }

        /* Sleep indicator */
        .sleep-indicator {
            background: linear-gradient(135deg, rgba(52, 152, 219, 0.2), rgba(41, 128, 185, 0.2));
            padding: 20px;
            border-radius: 12px;
            margin-top: 25px;
            border: 1px solid #3498db;
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .sleep-indicator i {
            font-size: 2rem;
            color: #3498db;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 25px;
            color: #3498db; /* M√†u xanh cho footer */
            font-size: 0.95rem;
            border-top: 1px solid #e9ecef;
            margin-top: 30px;
        }

        /* Password screen */
        .password-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #1a2980, #26d0ce);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .password-box {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
            text-align: center;
            max-width: 500px;
            width: 90%;
            animation: slideUp 0.5s ease-out;
        }

        @keyframes slideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .password-box h2 {
            margin-bottom: 20px;
            color: #3498db; /* M√†u xanh cho ti√™u ƒë·ªÅ */
        }

        .password-box p {
            color: #7f8c8d;
            margin-bottom: 30px;
        }

        .password-input {
            width: 100%;
            padding: 18px;
            border: 2px solid #3498db; /* M√†u xanh cho input */
            border-radius: 10px;
            font-size: 1.1rem;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .password-input:focus {
            border-color: #2980b9;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }

        .error-message {
            color: #e74c3c;
            margin-bottom: 20px;
            font-size: 0.95rem;
            display: none;
        }

        /* IP Address Input */
        .ip-input-group {
            margin: 20px 0;
            text-align: left;
        }

        .ip-input-group label {
            display: block;
            margin-bottom: 8px;
            color: #3498db;
            font-weight: 600;
        }

        .ip-input {
            width: 100%;
            padding: 15px;
            border: 2px solid #3498db;
            border-radius: 10px;
            font-size: 1.1rem;
            font-family: monospace;
            transition: all 0.3s;
        }

        .ip-input:focus {
            border-color: #2980b9;
            box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
            outline: none;
        }

        /* Notification */
        .notification {
            position: fixed;
            top: 30px;
            right: 30px;
            padding: 20px 30px;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 9999;
            display: none;
            animation: slideInRight 0.3s ease-out;
            max-width: 400px;
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .notification.success {
            background: linear-gradient(to right, #00b09b, #96c93d);
        }

        .notification.error {
            background: linear-gradient(to right, #ff416c, #ff4b2b);
        }

        .notification.info {
            background: linear-gradient(to right, #3498db, #2980b9); /* M√†u xanh cho th√¥ng b√°o info */
        }

        /* Loading spinner */
        .spinner {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: white;
            animation: spin 1s ease-in-out infinite;
            margin-left: 10px;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
                flex-direction: column;
                gap: 10px;
            }
            
            .current-time {
                font-size: 3rem;
            }
            
            .time-input {
                width: 80px;
                height: 70px;
                font-size: 2.5rem;
            }
            
            .btn-group {
                flex-direction: column;
            }
            
            .control-grid {
                grid-template-columns: 1fr;
            }
            
            .info-grid {
                grid-template-columns: 1fr;
            }
            
            .status-bar {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 10px;
        }

        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(to bottom, #3498db, #2980b9);
            border-radius: 5px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(to bottom, #2980b9, #1c5d87);
        }

        /* Value highlight */
        .value-highlight {
            color: #3498db;
            font-weight: 700;
        }

        /* Connection status */
        .connection-status {
            padding: 10px 15px;
            border-radius: 8px;
            font-weight: 600;
            display: inline-block;
            margin-top: 10px;
        }
        
        .connection-status.connected {
            background-color: rgba(52, 152, 219, 0.1);
            color: #3498db;
            border: 1px solid #3498db;
        }
        
        .connection-status.disconnected {
            background-color: rgba(231, 76, 60, 0.1);
            color: #e74c3c;
            border: 1px solid #e74c3c;
        }
    </style>
</head>
<body>
    <!-- M√†n h√¨nh ƒëƒÉng nh·∫≠p -->
    <div id="passwordScreen" class="password-screen">
        <div class="password-box">
            <h2><i class="fas fa-lock"></i> ƒêƒÉng Nh·∫≠p H·ªá Th·ªëng</h2>
            <p>Vui l√≤ng nh·∫≠p m·∫≠t kh·∫©u ƒë·ªÉ truy c·∫≠p b·∫£ng ƒëi·ªÅu khi·ªÉn ƒë·ªìng h·ªì th√¥ng minh</p>
            
            <div class="ip-input-group">
                <label for="ipAddressInput"><i class="fas fa-network-wired"></i> ƒê·ªãa ch·ªâ IP ESP32:</label>
                <input type="text" id="ipAddressInput" class="ip-input" 
                       value="192.168.1.100" 
                       placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ IP c·ªßa ESP32">
                <small style="color: #7f8c8d; display: block; margin-top: 5px;">
                    V√≠ d·ª•: 192.168.1.100, 192.168.4.1, ho·∫∑c ƒë·ªãa ch·ªâ IP local c·ªßa ESP32
                </small>
            </div>
            
            <div style="margin: 20px 0;">
                <input type="password" id="passwordInput" class="password-input" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" autocomplete="off">
                <div id="passwordError" class="error-message">
                    <i class="fas fa-exclamation-circle"></i> M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng. Vui l√≤ng th·ª≠ l·∫°i.
                </div>
            </div>
            
            <button id="loginBtn" class="btn btn-enable" style="width: 100%;">
                <i class="fas fa-sign-in-alt"></i> ƒêƒÉng Nh·∫≠p
            </button>
            
            <div style="margin-top: 30px; font-size: 0.9rem; color: #7f8c8d;">
                <p><i class="fas fa-info-circle"></i> M·∫≠t kh·∫©u m·∫∑c ƒë·ªãnh: <strong>123456</strong></p>
                <p><i class="fas fa-microchip"></i> Thi·∫øt b·ªã: ESP32-C3 ho·∫∑c ESP32 th√¥ng th∆∞·ªùng</p>
                <p><i class="fas fa-clock"></i> Phi√™n b·∫£n: 2.1 | C·∫≠p nh·∫≠t: 01/2024</p>
            </div>
        </div>
    </div>

    <!-- B·∫£ng ƒëi·ªÅu khi·ªÉn ch√≠nh -->
    <div id="controlPanel" class="container" style="display: none;">
        <!-- Header -->
        <div class="header">
            <h1><i class="fas fa-clock"></i> ƒê·ªìng H·ªì Th√¥ng Minh ESP32</h1>
            <p>ƒêi·ªÅu khi·ªÉn t·ª´ xa qua WiFi ‚Ä¢ C·∫≠p nh·∫≠t th·ªùi gian th·ª±c ‚Ä¢ Ti·∫øt ki·ªám nƒÉng l∆∞·ª£ng</p>
        </div>

        <!-- Status bar -->
        <div class="status-bar">
            <div class="status-item online">
                <i class="fas fa-wifi"></i>
                <span>WiFi: <span class="value-highlight">ƒê√£ k·∫øt n·ªëi</span> (Signal: 90%)</span>
            </div>
            <div class="status-item">
                <i class="fas fa-microchip"></i>
                <span>ESP32-C3 ‚Ä¢ <span class="value-highlight">240MHz</span> ‚Ä¢ 4MB Flash</span>
            </div>
            <div class="status-item">
                <i class="fas fa-battery-full"></i>
                <span>Ngu·ªìn: USB ‚Ä¢ <span class="value-highlight">Ho·∫°t ƒë·ªông ·ªïn ƒë·ªãnh</span></span>
            </div>
        </div>

        <!-- Hi·ªÉn th·ªã th·ªùi gian -->
        <div class="time-display">
            <div class="current-time" id="currentTime">00:00:00</div>
            <div class="current-date" id="currentDate">Th·ª© Hai, 01 Th√°ng 1, 2024</div>
        </div>

        <!-- Dashboard ch√≠nh -->
        <div class="dashboard">
            <!-- Card 1: ƒêi·ªÅu khi·ªÉn b√°o th·ª©c -->
            <div class="card">
                <h2 class="card-title"><i class="fas fa-bell"></i> ƒêi·ªÅu Khi·ªÉn B√°o Th·ª©c</h2>
                
                <div style="text-align: center; margin-bottom: 25px;">
                    <div style="font-weight: 600; color: #3498db; margin-bottom: 10px;">Th·ªùi gian b√°o th·ª©c</div>
                    <div class="time-input-group">
                        <input type="number" id="alarmHour" class="time-input" min="0" max="23" value="07" required>
                        <div class="time-separator">:</div>
                        <input type="number" id="alarmMinute" class="time-input" min="0" max="59" value="30" required>
                    </div>
                </div>
                
                <div style="margin-bottom: 25px;">
                    <div style="font-weight: 600; color: #3498db; margin-bottom: 10px;">√Çm thanh b√°o th·ª©c</div>
                    <select id="alarmSound" class="sound-select">
                        <option value="0">üîî Beep (M·∫∑c ƒë·ªãnh)</option>
                        <option value="1">üéµ Melody 1 (Nh·∫π nh√†ng)</option>
                        <option value="2">üé∂ Melody 2 (NƒÉng ƒë·ªông)</option>
                    </select>
                </div>
                
                <div class="btn-group">
                    <button id="enableAlarmBtn" class="btn btn-enable">
                        <i class="fas fa-play-circle"></i> B·∫≠t B√°o Th·ª©c
                    </button>
                    <button id="disableAlarmBtn" class="btn btn-disable">
                        <i class="fas fa-stop-circle"></i> T·∫Øt B√°o Th·ª©c
                    </button>
                </div>
                
                <div id="alarmStatus" class="alarm-status off">
                    <i class="fas fa-bell-slash"></i> B√°o th·ª©c ƒëang T·∫ÆT
                </div>
                
                <div style="margin-top: 20px; font-size: 0.9rem; color: #3498db; text-align: center;">
                    <p><i class="fas fa-info-circle"></i> B√°o th·ª©c t·ª± ƒë·ªông t·∫Øt sau 1 ph√∫t</p>
                </div>
            </div>

            <!-- Card 2: Th√¥ng tin h·ªá th·ªëng -->
            <div class="card">
                <h2 class="card-title"><i class="fas fa-chart-bar"></i> Th√¥ng Tin H·ªá Th·ªëng</h2>
                
                <div class="info-grid">
                    <div class="info-item">
                        <div class="info-label">ƒê·ªãa ch·ªâ IP</div>
                        <div class="info-value" id="ipAddress">192.168.1.100</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Th·ªùi gian ho·∫°t ƒë·ªông</div>
                        <div class="info-value" id="uptime">0 ph√∫t</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">B·ªô nh·ªõ c√≤n tr·ªëng</div>
                        <div class="info-value" id="freeMemory">65%</div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Tr·∫°ng th√°i Sleep</div>
                        <div class="info-value" id="sleepStatus">ƒêang ho·∫°t ƒë·ªông</div>
                    </div>
                </div>
                
                <!-- Hi·ªÉn th·ªã th·ªùi ti·∫øt v·ªõi ƒë·ªô ch√≠nh x√°c 2 s·ªë th·∫≠p ph√¢n -->
                <div class="weather-display">
                    <div class="weather-item">
                        <i class="fas fa-thermometer-half weather-icon"></i>
                        <div class="weather-value" id="temperature">25.50¬∞C</div>
                        <div class="weather-label">Nhi·ªát ƒë·ªô</div>
                    </div>
                    <div class="weather-item">
                        <i class="fas fa-tint weather-icon"></i>
                        <div class="weather-value" id="humidity">68.25%</div>
                        <div class="weather-label">ƒê·ªô ·∫©m</div>
                    </div>
                    <div class="weather-item">
                        <i class="fas fa-wind weather-icon"></i>
                        <div class="weather-value" id="pressure">1013.45 hPa</div>
                        <div class="weather-label">√Åp su·∫•t</div>
                    </div>
                </div>
                
                <!-- Th√¥ng tin ch·∫ø ƒë·ªô sleep -->
                <div class="sleep-indicator">
                    <i class="fas fa-bed"></i>
                    <div>
                        <div style="font-weight: 700; font-size: 1.1rem; color: #3498db;">Ch·∫ø ƒë·ªô Ti·∫øt Ki·ªám ƒêi·ªán</div>
                        <div style="font-size: 0.95rem; color: #7f8c8d;">H·ªá th·ªëng t·ª± ƒë·ªông v√†o Light Sleep sau 30 ph√∫t kh√¥ng c√≥ t∆∞∆°ng t√°c ƒë·ªÉ ti·∫øt ki·ªám nƒÉng l∆∞·ª£ng.</div>
                    </div>
                </div>
            </div>

            <!-- Card 3: ƒêi·ªÅu khi·ªÉn n√∫t -->
            <div class="card">
                <h2 class="card-title"><i class="fas fa-gamepad"></i> ƒêi·ªÅu Khi·ªÉn N√∫t V·∫≠t L√Ω</h2>
                
                <div style="margin-bottom: 20px; color: #3498db;">
                    <p>M√¥ ph·ªèng nh·∫•n n√∫t tr√™n ƒë·ªìng h·ªì t·ª´ xa:</p>
                </div>
                
                <div class="control-grid">
                    <button class="control-btn" data-btn="1">
                        <i class="fas fa-check-circle"></i>
                        <span>N√öT 1</span>
                        <small>Ch·ªçn / Enter</small>
                    </button>
                    <button class="control-btn" data-btn="2">
                        <i class="fas fa-arrow-up"></i>
                        <span>N√öT 2</span>
                        <small>TƒÉng gi√° tr·ªã</small>
                    </button>
                    <button class="control-btn" data-btn="3">
                        <i class="fas fa-arrow-down"></i>
                        <span>N√öT 3</span>
                        <small>Gi·∫£m gi√° tr·ªã</small>
                    </button>
                    <button id="snoozeBtn" class="control-btn">
                        <i class="fas fa-volume-mute"></i>
                        <span>T·∫ÆT B√ÅO TH·ª®C</span>
                        <small>Snooze / Dismiss</small>
                    </button>
                </div>
                
                <div style="margin-top: 25px;">
                    <button id="resetBtn" class="btn btn-disable" style="width: 100%;">
                        <i class="fas fa-redo"></i> KH·ªûI ƒê·ªòNG L·∫†I H·ªÜ TH·ªêNG
                    </button>
                    <div style="font-size: 0.85rem; color: #dc3545; margin-top: 10px; text-align: center;">
                        <i class="fas fa-exclamation-triangle"></i> C·∫£nh b√°o: Thi·∫øt b·ªã s·∫Ω m·∫•t k·∫øt n·ªëi trong 5-10 gi√¢y
                    </div>
                </div>
            </div>

            <!-- Card 4: H∆∞·ªõng d·∫´n & Tr·∫°ng th√°i -->
            <div class="card">
                <h2 class="card-title"><i class="fas fa-info-circle"></i> H∆∞·ªõng D·∫´n & Tr·∫°ng Th√°i</h2>
                
                <div style="margin-bottom: 25px;">
                    <div style="font-weight: 700; color: #3498db; margin-bottom: 15px;">üì± ƒêi·ªÅu Khi·ªÉn T·ª´ Xa</div>
                    <ul style="list-style-type: none; padding-left: 0;">
                        <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                            <i class="fas fa-check" style="position: absolute; left: 0; color: #3498db;"></i>
                            C·∫≠p nh·∫≠t th·ªùi gian th·ª±c t·ª´ internet (NTP)
                        </li>
                        <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                            <i class="fas fa-check" style="position: absolute; left: 0; color: #3498db;"></i>
                            Hi·ªÉn th·ªã th·ªùi ti·∫øt t·ª´ OpenWeather API
                        </li>
                        <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                            <i class="fas fa-check" style="position: absolute; left: 0; color: #3498db;"></i>
                            ƒê·∫∑t b√°o th·ª©c v·ªõi 3 √¢m thanh t√πy ch·ªçn
                        </li>
                        <li style="margin-bottom: 10px; padding-left: 25px; position: relative;">
                            <i class="fas fa-check" style="position: absolute; left: 0; color: #3498db;"></i>
                            Ch·∫ø ƒë·ªô Light Sleep ti·∫øt ki·ªám nƒÉng l∆∞·ª£ng
                        </li>
                    </ul>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin-top: 20px; border-left: 5px solid #3498db;">
                    <div style="font-weight: 700; color: #3498db; margin-bottom: 10px;">üîß Th√¥ng S·ªë K·ªπ Thu·∫≠t</div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span>Vi x·ª≠ l√Ω:</span>
                        <span style="font-weight: 600; color: #3498db;">ESP32-C3 RISC-V</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span>B·ªô nh·ªõ:</span>
                        <span style="font-weight: 600; color: #3498db;">4MB Flash, 400KB SRAM</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                        <span>M√†n h√¨nh:</span>
                        <span style="font-weight: 600; color: #3498db;">OLED 128x64 I2C</span>
                    </div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>K·∫øt n·ªëi:</span>
                        <span style="font-weight: 600; color: #3498db;">WiFi 802.11 b/g/n</span>
                    </div>
                </div>
                
                <div style="margin-top: 25px; text-align: center;">
                    <button id="refreshBtn" class="btn" style="background: linear-gradient(to right, #3498db, #2980b9); color: white;">
                        <i class="fas fa-sync-alt"></i> L√†m M·ªõi D·ªØ Li·ªáu
                    </button>
                    <div id="connectionStatus" class="connection-status connected" style="margin-top: 15px;">
                        <i class="fas fa-check-circle"></i> ƒê√£ k·∫øt n·ªëi v·ªõi ESP32
                    </div>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <div class="footer">
            <p>¬© 2024 ƒê·ªì √Ån IoT - ƒê·ªìng H·ªì Th√¥ng Minh ESP32-C3 | Nh√≥m Sinh Vi√™n K·ªπ Thu·∫≠t</p>
            <p>Phi√™n b·∫£n: 2.1 | File: time.html | C·∫≠p nh·∫≠t: 01/01/2024</p>
            <p>ƒê·ªãa ch·ªâ IP hi·ªán t·∫°i: <span id="currentIpAddress" class="value-highlight">192.168.1.100</span></p>
        </div>
    </div>

    <!-- Th√¥ng b√°o -->
    <div id="notification" class="notification"></div>

    <script>
        // ========== BI·∫æN TO√ÄN C·ª§C ==========
        let deviceData = {
            ip: "192.168.1.100", // IP m·∫∑c ƒë·ªãnh
            isConnected: true,
            alarmEnabled: false,
            alarmHour: 7,
            alarmMinute: 30,
            alarmSound: 0,
            temperature: 25.50, // ƒê·ªô ch√≠nh x√°c 2 s·ªë th·∫≠p ph√¢n
            humidity: 68.25,    // ƒê·ªô ch√≠nh x√°c 2 s·ªë th·∫≠p ph√¢n
            pressure: 1013.45,  // ƒê·ªô ch√≠nh x√°c 2 s·ªë th·∫≠p ph√¢n
            uptime: 0,
            sleepMode: false,
            lastUpdate: new Date()
        };
        
        let isAuthenticated = false;
        let connectionInterval;
        let updateInterval;
        let notificationTimeout;
        let esp32Ip = "192.168.1.100"; // Bi·∫øn l∆∞u IP c·ªßa ESP32

        // ========== DOM ELEMENTS ==========
        const elements = {
            passwordScreen: document.getElementById('passwordScreen'),
            controlPanel: document.getElementById('controlPanel'),
            passwordInput: document.getElementById('passwordInput'),
            ipAddressInput: document.getElementById('ipAddressInput'),
            loginBtn: document.getElementById('loginBtn'),
            passwordError: document.getElementById('passwordError'),
            currentTime: document.getElementById('currentTime'),
            currentDate: document.getElementById('currentDate'),
            alarmStatus: document.getElementById('alarmStatus'),
            ipAddress: document.getElementById('ipAddress'),
            currentIpAddress: document.getElementById('currentIpAddress'),
            temperature: document.getElementById('temperature'),
            humidity: document.getElementById('humidity'),
            pressure: document.getElementById('pressure'),
            uptime: document.getElementById('uptime'),
            freeMemory: document.getElementById('freeMemory'),
            sleepStatus: document.getElementById('sleepStatus'),
            connectionStatus: document.getElementById('connectionStatus'),
            notification: document.getElementById('notification'),
            alarmHour: document.getElementById('alarmHour'),
            alarmMinute: document.getElementById('alarmMinute'),
            alarmSound: document.getElementById('alarmSound'),
            enableAlarmBtn: document.getElementById('enableAlarmBtn'),
            disableAlarmBtn: document.getElementById('disableAlarmBtn'),
            snoozeBtn: document.getElementById('snoozeBtn'),
            resetBtn: document.getElementById('resetBtn'),
            refreshBtn: document.getElementById('refreshBtn')
        };

        // ========== H√ÄM KI·ªÇM TRA IP H·ª¢P L·ªÜ ==========
        function isValidIP(ip) {
            const ipRegex = /^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/;
            return ipRegex.test(ip);
        }

        // ========== H√ÄM HI·ªÜN TH√îNG B√ÅO ==========
        function showNotification(message, type = 'info', duration = 3000) {
            if (notificationTimeout) clearTimeout(notificationTimeout);
            
            elements.notification.textContent = message;
            elements.notification.className = `notification ${type}`;
            elements.notification.style.display = 'block';
            
            notificationTimeout = setTimeout(() => {
                elements.notification.style.display = 'none';
            }, duration);
        }

        // ========== H√ÄM C·∫¨P NH·∫¨T TH·ªúI GIAN ==========
        function updateClock() {
            const now = new Date();
            
            const timeString = now.toLocaleTimeString('vi-VN', { 
                hour12: false,
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            const dateOptions = {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            };
            const dateString = now.toLocaleDateString('vi-VN', dateOptions);
            
            elements.currentTime.textContent = timeString;
            elements.currentDate.textContent = dateString;
            
            if (now.getSeconds() % 2 === 0) {
                elements.currentTime.style.opacity = '1';
            } else {
                elements.currentTime.style.opacity = '0.95';
            }
        }

        // ========== H√ÄM C·∫¨P NH·∫¨T D·ªÆ LI·ªÜU TH·ªúI TI·∫æT ==========
        function updateWeatherData() {
            // T·∫°o d·ªØ li·ªáu th·ªùi ti·∫øt ng·∫´u nhi√™n v·ªõi ƒë·ªô ch√≠nh x√°c 2 s·ªë th·∫≠p ph√¢n
            deviceData.temperature = (Math.random() * 15 + 20).toFixed(2); // 20-35¬∞C
            deviceData.humidity = (Math.random() * 30 + 50).toFixed(2);    // 50-80%
            deviceData.pressure = (Math.random() * 20 + 1000).toFixed(2);  // 1000-1020 hPa
            
            // C·∫≠p nh·∫≠t DOM v·ªõi ƒë·ªãnh d·∫°ng 2 s·ªë th·∫≠p ph√¢n
            elements.temperature.textContent = `${deviceData.temperature}¬∞C`;
            elements.humidity.textContent = `${deviceData.humidity}%`;
            elements.pressure.textContent = `${deviceData.pressure} hPa`;
        }

        // ========== H√ÄM M√î PH·ªéNG K·∫æT N·ªêI ESP32 ==========
        function simulateESP32Connection() {
            // C·∫≠p nh·∫≠t th·ªùi gian ho·∫°t ƒë·ªông
            if (deviceData.isConnected) {
                deviceData.uptime += 1;
                elements.uptime.textContent = `${deviceData.uptime} ph√∫t`;
                
                // C·∫≠p nh·∫≠t d·ªØ li·ªáu th·ªùi ti·∫øt m·ªói 10 gi√¢y
                if (deviceData.uptime % 10 === 0) {
                    updateWeatherData();
                }
                
                // C·∫≠p nh·∫≠t tr·∫°ng th√°i sleep
                deviceData.sleepMode = deviceData.uptime > 30;
                elements.sleepStatus.textContent = deviceData.sleepMode ? "Light Sleep" : "ƒêang ho·∫°t ƒë·ªông";
                elements.sleepStatus.style.color = deviceData.sleepMode ? "#e74c3c" : "#27ae60";
                
                // C·∫≠p nh·∫≠t b·ªô nh·ªõ c√≤n tr·ªëng
                const freeMem = Math.max(20, 100 - deviceData.uptime * 0.3).toFixed(0);
                elements.freeMemory.textContent = `${freeMem}%`;
                
                // C·∫≠p nh·∫≠t tr·∫°ng th√°i k·∫øt n·ªëi
                elements.connectionStatus.className = 'connection-status connected';
                elements.connectionStatus.innerHTML = `<i class="fas fa-check-circle"></i> ƒê√£ k·∫øt n·ªëi v·ªõi ESP32 (${esp32Ip})`;
            } else {
                elements.connectionStatus.className = 'connection-status disconnected';
                elements.connectionStatus.innerHTML = `<i class="fas fa-times-circle"></i> M·∫•t k·∫øt n·ªëi v·ªõi ESP32`;
            }
        }

        // ========== H√ÄM X·ª¨ L√ù ƒêƒÇNG NH·∫¨P ==========
        function handleLogin() {
            const password = elements.passwordInput.value.trim();
            const ip = elements.ipAddressInput.value.trim();
            const correctPassword = "123456";
            
            // Ki·ªÉm tra IP h·ª£p l·ªá
            if (!isValidIP(ip)) {
                showNotification('‚ùå ƒê·ªãa ch·ªâ IP kh√¥ng h·ª£p l·ªá! Vui l√≤ng nh·∫≠p IP ƒë√∫ng ƒë·ªãnh d·∫°ng.', 'error');
                elements.ipAddressInput.focus();
                return;
            }
            
            if (password === correctPassword) {
                // L∆∞u IP c·ªßa ESP32
                esp32Ip = ip;
                deviceData.ip = ip;
                
                // Login success
                isAuthenticated = true;
                elements.passwordError.style.display = 'none';
                elements.passwordScreen.style.display = 'none';
                elements.controlPanel.style.display = 'block';
                
                // C·∫≠p nh·∫≠t IP tr√™n giao di·ªán
                elements.ipAddress.textContent = esp32Ip;
                elements.currentIpAddress.textContent = esp32Ip;
                
                // Kh·ªüi t·∫°o ƒë·ªìng h·ªì
                updateClock();
                setInterval(updateClock, 1000);
                
                // Kh·ªüi t·∫°o d·ªØ li·ªáu th·ªùi ti·∫øt
                updateWeatherData();
                
                // B·∫Øt ƒë·∫ßu m√¥ ph·ªèng k·∫øt n·ªëi
                connectionInterval = setInterval(simulateESP32Connection, 2000);
                
                // Hi·ªÉn th·ªã th√¥ng b√°o th√†nh c√¥ng
                showNotification(`‚úÖ ƒêƒÉng nh·∫≠p th√†nh c√¥ng! ƒêang k·∫øt n·ªëi ƒë·∫øn ESP32 t·∫°i ${esp32Ip}`, 'success');
                
                // Thi·∫øt l·∫≠p gi√° tr·ªã b√°o th·ª©c ban ƒë·∫ßu
                elements.alarmHour.value = deviceData.alarmHour;
                elements.alarmMinute.value = deviceData.alarmMinute;
                elements.alarmSound.value = deviceData.alarmSound;
                updateAlarmStatusDisplay();
                
            } else {
                // Login failed
                elements.passwordError.style.display = 'block';
                elements.passwordInput.value = '';
                elements.passwordInput.focus();
                showNotification('‚ùå M·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!', 'error');
            }
        }

        // ========== H√ÄM C·∫¨P NH·∫¨T HI·ªÇN TH·ªä TR·∫†NG TH√ÅI B√ÅO TH·ª®C ==========
        function updateAlarmStatusDisplay() {
            if (deviceData.alarmEnabled) {
                const hourStr = deviceData.alarmHour.toString().padStart(2, '0');
                const minuteStr = deviceData.alarmMinute.toString().padStart(2, '0');
                
                elements.alarmStatus.className = 'alarm-status on';
                elements.alarmStatus.innerHTML = `
                    <i class="fas fa-bell"></i> B√°o th·ª©c B·∫¨T l√∫c ${hourStr}:${minuteStr}
                `;
            } else {
                elements.alarmStatus.className = 'alarm-status off';
                elements.alarmStatus.innerHTML = `
                    <i class="fas fa-bell-slash"></i> B√°o th·ª©c ƒëang T·∫ÆT
                `;
            }
        }

        // ========== H√ÄM G·ª¨I L·ªÜNH ƒê·∫æN ESP32 (TH·ª∞C T·∫æ) ==========
        async function sendCommandToESP32(endpoint, params = {}) {
            try {
                // T·∫°o URL v·ªõi IP c·ªßa ESP32
                const url = `http://${esp32Ip}${endpoint}`;
                const queryString = new URLSearchParams(params).toString();
                const fullUrl = queryString ? `${url}?${queryString}` : url;
                
                console.log(`G·ª≠i l·ªánh ƒë·∫øn ESP32: ${fullUrl}`);
                
                // Trong m√¥i tr∆∞·ªùng th·ª±c t·∫ø, s·ª≠ d·ª•ng fetch()
                // const response = await fetch(fullUrl, {
                //     method: 'GET',
                //     headers: {
                //         'Content-Type': 'application/json'
                //     }
                // });
                
                // if (!response.ok) {
                //     throw new Error(`HTTP error! status: ${response.status}`);
                // }
                
                // const data = await response.json();
                // return data;
                
                // M√¥ ph·ªèng th√†nh c√¥ng
                return new Promise((resolve) => {
                    setTimeout(() => {
                        resolve({ 
                            success: true, 
                            message: "L·ªánh ƒë√£ ƒë∆∞·ª£c g·ª≠i th√†nh c√¥ng ƒë·∫øn ESP32",
                            ip: esp32Ip
                        });
                    }, 500);
                });
                
            } catch (error) {
                console.error('L·ªói khi g·ª≠i l·ªánh ƒë·∫øn ESP32:', error);
                return { 
                    success: false, 
                    message: `L·ªói k·∫øt n·ªëi: ${error.message}` 
                };
            }
        }

        // ========== H√ÄM X·ª¨ L√ù B·∫¨T/T·∫ÆT B√ÅO TH·ª®C ==========
        async function handleAlarmControl(enable) {
            const hour = parseInt(elements.alarmHour.value);
            const minute = parseInt(elements.alarmMinute.value);
            const sound = parseInt(elements.alarmSound.value);
            
            if (isNaN(hour) || hour < 0 || hour > 23 ||
                isNaN(minute) || minute < 0 || minute > 59) {
                showNotification('‚ùå Th·ªùi gian kh√¥ng h·ª£p l·ªá! Vui l√≤ng ki·ªÉm tra l·∫°i.', 'error');
                return;
            }
            
            // C·∫≠p nh·∫≠t d·ªØ li·ªáu local
            deviceData.alarmEnabled = enable;
            deviceData.alarmHour = hour;
            deviceData.alarmMinute = minute;
            deviceData.alarmSound = sound;
            
            // C·∫≠p nh·∫≠t hi·ªÉn th·ªã
            updateAlarmStatusDisplay();
            
            // G·ª≠i l·ªánh ƒë·∫øn ESP32
            const result = await sendCommandToESP32('/setAlarmDirect', {
                hour, minute, sound, enable: enable ? 1 : 0
            });
            
            if (result.success) {
                const hourStr = hour.toString().padStart(2, '0');
                const minuteStr = minute.toString().padStart(2, '0');
                const soundNames = ['Beep', 'Melody 1', 'Melody 2'];
                
                if (enable) {
                    showNotification(
                        `‚úÖ ƒê√£ ƒë·∫∑t b√°o th·ª©c l√∫c ${hourStr}:${minuteStr} (√Çm thanh: ${soundNames[sound]})`,
                        'success',
                        4000
                    );
                } else {
                    showNotification('‚úÖ ƒê√£ t·∫Øt b√°o th·ª©c', 'success');
                }
            } else {
                showNotification(`‚ùå Kh√¥ng th·ªÉ g·ª≠i l·ªánh: ${result.message}`, 'error');
            }
            
            // Reset sleep timer
            resetSleepTimer();
        }

        // ========== H√ÄM X·ª¨ L√ù N√öT ƒêI·ªÄU KHI·ªÇN ==========
        async function handleButtonControl(buttonId) {
            const buttonNames = {
                1: { name: "N√∫t 1", desc: "Ch·ªçn/Enter" },
                2: { name: "N√∫t 2", desc: "TƒÉng gi√° tr·ªã" },
                3: { name: "N√∫t 3", desc: "Gi·∫£m gi√° tr·ªã" }
            };
            
            const button = buttonNames[buttonId];
            
            // G·ª≠i l·ªánh ƒë·∫øn ESP32
            const result = await sendCommandToESP32('/button', { btn: buttonId });
            
            if (result.success) {
                showNotification(
                    `üì± ƒê√£ g·ª≠i l·ªánh ${button.name} (${button.desc}) ƒë·∫øn ESP32`,
                    'info'
                );
            } else {
                showNotification(`‚ùå Kh√¥ng th·ªÉ g·ª≠i l·ªánh n√∫t: ${result.message}`, 'error');
            }
            
            resetSleepTimer();
        }

        // ========== H√ÄM X·ª¨ L√ù T·∫ÆT B√ÅO TH·ª®C ==========
        async function handleSnooze() {
            if (deviceData.alarmEnabled) {
                // G·ª≠i l·ªánh ƒë·∫øn ESP32
                const result = await sendCommandToESP32('/snooze');
                
                if (result.success) {
                    deviceData.alarmEnabled = false;
                    updateAlarmStatusDisplay();
                    showNotification('üîá ƒê√£ t·∫Øt b√°o th·ª©c t·∫°m th·ªùi', 'info');
                } else {
                    showNotification(`‚ùå Kh√¥ng th·ªÉ t·∫Øt b√°o th·ª©c: ${result.message}`, 'error');
                }
            } else {
                showNotification('‚ÑπÔ∏è Hi·ªán kh√¥ng c√≥ b√°o th·ª©c n√†o ƒëang k√≠ch ho·∫°t', 'info');
            }
            
            resetSleepTimer();
        }

        // ========== H√ÄM X·ª¨ L√ù RESET H·ªÜ TH·ªêNG ==========
        async function handleReset() {
            if (confirm('‚ö†Ô∏è B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën kh·ªüi ƒë·ªông l·∫°i ESP32?\n\nThi·∫øt b·ªã s·∫Ω m·∫•t k·∫øt n·ªëi trong 5-10 gi√¢y.')) {
                showNotification('üîÑ ƒêang kh·ªüi ƒë·ªông l·∫°i ESP32...', 'info', 5000);
                
                // G·ª≠i l·ªánh reset ƒë·∫øn ESP32
                const result = await sendCommandToESP32('/reset');
                
                if (result.success) {
                    // M√¥ ph·ªèng reset
                    deviceData.isConnected = false;
                    deviceData.uptime = 0;
                    
                    // Hi·ªÉn th·ªã tr·∫°ng th√°i ƒëang kh·ªüi ƒë·ªông l·∫°i
                    elements.connectionStatus.className = 'connection-status disconnected';
                    elements.connectionStatus.innerHTML = `<i class="fas fa-sync-alt fa-spin"></i> ƒêang kh·ªüi ƒë·ªông l·∫°i...`;
                    
                    // M√¥ ph·ªèng k·∫øt n·ªëi l·∫°i sau 5 gi√¢y
                    setTimeout(() => {
                        deviceData.isConnected = true;
                        showNotification('‚úÖ ESP32 ƒë√£ kh·ªüi ƒë·ªông l·∫°i th√†nh c√¥ng!', 'success');
                    }, 5000);
                } else {
                    showNotification(`‚ùå Kh√¥ng th·ªÉ kh·ªüi ƒë·ªông l·∫°i: ${result.message}`, 'error');
                }
                
                resetSleepTimer();
            }
        }

        // ========== H√ÄM RESET SLEEP TIMER ==========
        async function resetSleepTimer() {
            // G·ª≠i l·ªánh reset sleep timer ƒë·∫øn ESP32
            try {
                await sendCommandToESP32('/resetSleepTimer');
                console.log("Sleep timer ƒë√£ ƒë∆∞·ª£c reset");
            } catch (error) {
                console.error("Kh√¥ng th·ªÉ reset sleep timer:", error);
            }
        }

        // ========== H√ÄM L√ÄM M·ªöI D·ªÆ LI·ªÜU ==========
        async function handleRefresh() {
            showNotification('üîÑ ƒêang l√†m m·ªõi d·ªØ li·ªáu t·ª´ ESP32...', 'info');
            
            // C·∫≠p nh·∫≠t d·ªØ li·ªáu th·ªùi ti·∫øt
            updateWeatherData();
            
            // K√≠ch ho·∫°t k·∫øt n·ªëi m√¥ ph·ªèng
            simulateESP32Connection();
            
            resetSleepTimer();
        }

        // ========== KH·ªûI T·∫†O S·ª∞ KI·ªÜN ==========
        function initializeEventListeners() {
            // Login events
            elements.loginBtn.addEventListener('click', handleLogin);
            elements.passwordInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleLogin();
            });
            elements.ipAddressInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') handleLogin();
            });
            
            // Alarm control events
            elements.enableAlarmBtn.addEventListener('click', () => handleAlarmControl(true));
            elements.disableAlarmBtn.addEventListener('click', () => handleAlarmControl(false));
            
            // Button control events
            document.querySelectorAll('.control-btn[data-btn]').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const buttonId = parseInt(e.currentTarget.getAttribute('data-btn'));
                    handleButtonControl(buttonId);
                });
            });
            
            // Other button events
            elements.snoozeBtn.addEventListener('click', handleSnooze);
            elements.resetBtn.addEventListener('click', handleReset);
            elements.refreshBtn.addEventListener('click', handleRefresh);
            
            // Reset sleep timer on any interaction
            document.addEventListener('click', resetSleepTimer);
            document.addEventListener('keypress', resetSleepTimer);
            
            // Auto refresh page every 30 minutes
            setTimeout(() => {
                if (isAuthenticated && confirm('T·ª± ƒë·ªông l√†m m·ªõi trang ƒë·ªÉ c·∫≠p nh·∫≠t d·ªØ li·ªáu?')) {
                    location.reload();
                }
            }, 30 * 60 * 1000);
        }

        // ========== KH·ªûI ƒê·ªòNG ·ª®NG D·ª§NG ==========
        document.addEventListener('DOMContentLoaded', () => {
            // Kh·ªüi t·∫°o
            updateClock();
            initializeEventListeners();
            
            // Auto-focus password input
            elements.ipAddressInput.focus();
            elements.ipAddressInput.select();
            
            // Log startup
            console.log('Smart Clock Web Control Panel ƒë√£ kh·ªüi ƒë·ªông!');
            console.log('File: time.html');
            console.log('M·∫≠t kh·∫©u m·∫∑c ƒë·ªãnh: 123456');
            console.log('Nh·∫≠p ƒë·ªãa ch·ªâ IP c·ªßa ESP32 ƒë·ªÉ k·∫øt n·ªëi');
        });
    </script>
</body>
</html>
